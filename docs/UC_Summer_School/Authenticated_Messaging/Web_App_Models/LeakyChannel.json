{
  "model": {
    "interfaces": {
      "compInters": [
        {
          "basicInterfaces": [
            {
              "idOfBasic": "75036ee9-3ae8-4835-5c46-060054a19b0c",
              "idOfInstance": "bb0fcf46-5050-ea9c-04b4-f614bdd14fa1",
              "name": "API"
            }
          ],
          "id": "5e8fe49f-00c5-4fe6-ef8b-a3ca9604a87a",
          "interfaceComment": "",
          "name": "D",
          "type": "direct"
        }
      ],
      "basicInters": [
        {
          "id": "75036ee9-3ae8-4835-5c46-060054a19b0c",
          "interfaceComment": "The main API for the system",
          "messages": [
            "fb79cf4f-f4ac-8661-3eb3-a453b74ee2aa",
            "056bf4d5-ad32-8615-8110-fd30a2b7cab6"
          ],
          "name": "ChannelAPI",
          "type": "direct"
        },
        {
          "id": "23b1289c-bad5-7a7a-b909-6db70f64ea71",
          "interfaceComment": "",
          "messages": [
            "0648a529-fd79-8070-d821-3dea27407503",
            "df7710ea-5eb0-7c64-aac7-835bb213aa97",
            "5f7496fb-53fe-1e59-38c2-d38d4bf605d7"
          ],
          "name": "ChannelAdvAPI",
          "type": "adversarial"
        }
      ],
      "messages": [
        {
          "id": "fb79cf4f-f4ac-8661-3eb3-a453b74ee2aa",
          "messageComment": "Allows the caller to send a message to the port *internal_port* with an authentication token.",
          "name": "send_msg",
          "parameters": [
            {
              "id": "91b86154-3b0b-6f35-1a31-37aac352cbf8",
              "name": "msg",
              "type": "univ"
            },
            {
              "id": "ba55d80f-6031-5cdd-003b-5f59c511153a",
              "name": "auth_token",
              "type": "UINT256"
            },
            {
              "id": "76efffcf-9768-a0f4-27d9-96aba0b19761",
              "name": "internal_port",
              "type": "port"
            }
          ],
          "port": "pt",
          "type": "in"
        },
        {
          "id": "056bf4d5-ad32-8615-8110-fd30a2b7cab6",
          "messageComment": "Delivers a previously sent message.",
          "name": "deliver_msg",
          "parameters": [
            {
              "id": "511e400c-4a39-3cb4-ad8f-c9480a901ed8",
              "name": "msg",
              "type": "univ"
            },
            {
              "id": "8b46af5b-1e21-044b-3925-ac525d0cb0d3",
              "name": "auth_token",
              "type": "UINT265"
            }
          ],
          "port": "pt",
          "type": "out"
        },
        {
          "id": "0648a529-fd79-8070-d821-3dea27407503",
          "messageComment": "Leaks a message and its token to the adversary.",
          "name": "leak_msg",
          "parameters": [
            {
              "id": "ed6bc845-40d5-32ef-d400-d799036489a9",
              "name": "msg",
              "type": "univ"
            },
            {
              "id": "7acbf8b0-c275-da71-1a99-ded8f3c32ac3",
              "name": "auth_token",
              "type": "UINT256"
            }
          ],
          "port": "",
          "type": "out"
        },
        {
          "id": "df7710ea-5eb0-7c64-aac7-835bb213aa97",
          "messageComment": "Allows the adversary to inject a message into the channel.",
          "name": "inject_msg",
          "parameters": [
            {
              "id": "24017d17-e20b-331b-e65c-23b2e96ded13",
              "name": "msg",
              "type": "univ"
            },
            {
              "id": "4c67a453-3270-7ef2-8eb6-0ea0dbeef18c",
              "name": "auth_token",
              "type": "UINT256"
            },
            {
              "id": "861261c2-98d1-2663-317b-508aac605296",
              "name": "internal_port",
              "type": "port"
            }
          ],
          "port": "",
          "type": "in"
        },
        {
          "id": "5f7496fb-53fe-1e59-38c2-d38d4bf605d7",
          "messageComment": "Tells the functionality to deliver the next message in the FIFO queue.",
          "name": "deliver_msg",
          "parameters": [],
          "port": "",
          "type": "in"
        }
      ]
    },
    "parties": {
      "parties": []
    },
    "subfunctionalities": {
      "subfunctionalities": []
    },
    "realFunctionality": {
      "parties": [],
      "subfunctionalities": [],
      "id": "3048ff28-7130-8cc3-348d-60f172dd6f8a",
      "name": "Real_Functionality",
      "compositeDirectInterface": "5e8fe49f-00c5-4fe6-ef8b-a3ca9604a87a",
      "compositeAdversarialInterface": "",
      "parameterInterfaces": []
    },
    "simulator": {
      "id": "5c9892c5-2f0b-6034-7580-bc3b4d75d799",
      "name": "Sim",
      "basicAdversarialInterface": "",
      "realFunctionality": "",
      "stateMachine": "f77aef8f-ab6f-a3d8-51d8-cae3f1fbc141",
      "color": "#6bb45c",
      "left": 450,
      "top": 201
    },
    "idealFunctionality": {
      "id": "d4c25c48-ff7b-28c4-a338-4017a52b16eb",
      "name": "IF",
      "basicAdversarialInterface": "23b1289c-bad5-7a7a-b909-6db70f64ea71",
      "compositeDirectInterface": "5e8fe49f-00c5-4fe6-ef8b-a3ca9604a87a",
      "stateMachine": "86b64ef6-c71c-72ad-06d7-f98d686d0b2b",
      "color": "#3e88c7",
      "left": 250,
      "top": 250
    },
    "stateMachines": {
      "stateMachines": [
        {
          "id": "86b64ef6-c71c-72ad-06d7-f98d686d0b2b",
          "initState": "a05fa213-644d-f62b-8e42-233c73b45b9b",
          "states": [
            "a05fa213-644d-f62b-8e42-233c73b45b9b",
            "70f7e8fa-37e0-4f75-7ab5-825587c3b1d0"
          ],
          "transitions": [
            "9dbd5571-9c03-57f3-303f-ba5e58c06f3b",
            "306e1e4b-960f-2a5e-f510-23220659f749",
            "72256e05-fe93-b8ef-0ce1-8d397d03301e",
            "fd7c633d-7c14-f63c-110b-6f7390cf828d"
          ]
        },
        {
          "id": "f77aef8f-ab6f-a3d8-51d8-cae3f1fbc141",
          "initState": "1190cfae-aea7-9d91-6fed-3b7f164b1fcf",
          "states": [
            "1190cfae-aea7-9d91-6fed-3b7f164b1fcf"
          ],
          "transitions": []
        }
      ],
      "states": [
        {
          "color": "#e3c85b",
          "comment": "",
          "id": "a05fa213-644d-f62b-8e42-233c73b45b9b",
          "left": 25,
          "name": "InitState",
          "parameters": [],
          "top": 50
        },
        {
          "color": "#e3c85b",
          "comment": "",
          "id": "1190cfae-aea7-9d91-6fed-3b7f164b1fcf",
          "left": 25,
          "name": "InitState",
          "parameters": [],
          "top": 50
        },
        {
          "color": "#c4dd88",
          "comment": "",
          "id": "70f7e8fa-37e0-4f75-7ab5-825587c3b1d0",
          "left": 361,
          "name": "Main",
          "parameters": [
            {
              "id": "e1fa6bb5-94db-2ddf-5405-fa0f8295c657",
              "name": "messageQueue",
              "type": "(univ, UINT256, port, port) list"
            }
          ],
          "top": 151
        }
      ],
      "transitions": [
        {
          "fromState": "a05fa213-644d-f62b-8e42-233c73b45b9b",
          "guard": "",
          "id": "9dbd5571-9c03-57f3-303f-ba5e58c06f3b",
          "inMessage": "fb79cf4f-f4ac-8661-3eb3-a453b74ee2aa",
          "name": "Initial Send Message",
          "outMessage": "0648a529-fd79-8070-d821-3dea27407503",
          "outMessageArguments": [
            {
              "argValue": "msg",
              "paraID": "ed6bc845-40d5-32ef-d400-d799036489a9"
            },
            {
              "argValue": "auth_token",
              "paraID": "7acbf8b0-c275-da71-1a99-ded8f3c32ac3"
            }
          ],
          "sourceHandle": "13",
          "targetHandle": "4",
          "targetPort": "",
          "toState": "70f7e8fa-37e0-4f75-7ab5-825587c3b1d0",
          "toStateArguments": [
            {
              "argValue": "[(msg, auth_token, internal_port)]",
              "paraID": "e1fa6bb5-94db-2ddf-5405-fa0f8295c657"
            }
          ]
        },
        {
          "fromState": "70f7e8fa-37e0-4f75-7ab5-825587c3b1d0",
          "guard": "",
          "id": "306e1e4b-960f-2a5e-f510-23220659f749",
          "inMessage": "5f7496fb-53fe-1e59-38c2-d38d4bf605d7",
          "name": "Deliver Message",
          "outMessage": "056bf4d5-ad32-8615-8110-fd30a2b7cab6",
          "outMessageArguments": [
            {
              "argValue": "head.`1",
              "paraID": "511e400c-4a39-3cb4-ad8f-c9480a901ed8"
            },
            {
              "argValue": "head.`2",
              "paraID": "8b46af5b-1e21-044b-3925-ac525d0cb0d3"
            }
          ],
          "sourceHandle": "15",
          "targetHandle": "16",
          "targetPort": "head.`3",
          "toState": "70f7e8fa-37e0-4f75-7ab5-825587c3b1d0",
          "toStateArguments": [
            {
              "argValue": "behead(messageQueue)",
              "paraID": "e1fa6bb5-94db-2ddf-5405-fa0f8295c657"
            }
          ]
        },
        {
          "fromState": "70f7e8fa-37e0-4f75-7ab5-825587c3b1d0",
          "guard": "",
          "id": "72256e05-fe93-b8ef-0ce1-8d397d03301e",
          "inMessage": "fb79cf4f-f4ac-8661-3eb3-a453b74ee2aa",
          "name": "Send Message",
          "outMessage": "0648a529-fd79-8070-d821-3dea27407503",
          "outMessageArguments": [
            {
              "argValue": "msg",
              "paraID": "ed6bc845-40d5-32ef-d400-d799036489a9"
            },
            {
              "argValue": "auth_token",
              "paraID": "7acbf8b0-c275-da71-1a99-ded8f3c32ac3"
            }
          ],
          "sourceHandle": "11",
          "targetHandle": "12",
          "targetPort": "",
          "toState": "70f7e8fa-37e0-4f75-7ab5-825587c3b1d0",
          "toStateArguments": [
            {
              "argValue": "messageQueue ++ [(msg, auth_token, internal_port)]",
              "paraID": "e1fa6bb5-94db-2ddf-5405-fa0f8295c657"
            }
          ]
        },
        {
          "fromState": "70f7e8fa-37e0-4f75-7ab5-825587c3b1d0",
          "guard": "",
          "id": "fd7c633d-7c14-f63c-110b-6f7390cf828d",
          "inMessage": "df7710ea-5eb0-7c64-aac7-835bb213aa97",
          "name": "Inject Message",
          "outMessage": "0648a529-fd79-8070-d821-3dea27407503",
          "outMessageArguments": [
            {
              "argValue": "msg",
              "paraID": "ed6bc845-40d5-32ef-d400-d799036489a9"
            },
            {
              "argValue": "auth_token",
              "paraID": "7acbf8b0-c275-da71-1a99-ded8f3c32ac3"
            }
          ],
          "sourceHandle": "7",
          "targetHandle": "8",
          "targetPort": "",
          "toState": "70f7e8fa-37e0-4f75-7ab5-825587c3b1d0",
          "toStateArguments": [
            {
              "argValue": "messageQueue ++ [(msg, auth_token, internal_port)]",
              "paraID": "e1fa6bb5-94db-2ddf-5405-fa0f8295c657"
            }
          ]
        }
      ]
    },
    "id": "4c908595-ce77-0469-c066-377743e3e2fe",
    "name": "LeakyChannel",
    "readOnly": false,
    "modelVersion": "1.3"
  },
  "readOnly": "",
  "lastModified": 1754668815.034263,
  "modelVersion": "1.3"
}